---
layout: post
title:  "Code"
date:   2018-09-20 00:27:00 -0400
author: Yingjie Song
categories: COMP2801
tag: 2801
---
<h2>LawnMower</h2>

{% highlight java %}
import lejos.hardware.Button;
import lejos.hardware.Sound;
import lejos.hardware.port.SensorPort;
import lejos.hardware.sensor.EV3TouchSensor;
import lejos.hardware.motor.*;

public class LawnMower {
	public static void main(String[] args) throws Exception {
		Sound.beepSequenceUp();

		EV3TouchSensor propel = new EV3TouchSensor(SensorPort.S2);
		EV3TouchSensor onOff = new EV3TouchSensor(SensorPort.S3);

		NXTRegulatedMotor leftMotor = Motor.A;
		NXTRegulatedMotor rightMotor = Motor.D;
		NXTRegulatedMotor bladeMotor = Motor.B;

		bladeMotor.setAcceleration(500);
		leftMotor.setAcceleration(750);
		rightMotor.setAcceleration(750);
		bladeMotor.setSpeed(1000);
		leftMotor.setSpeed(300);
		rightMotor.setSpeed(300);
		
		float[] propelReadings = new float[propel.sampleSize()];
		float[] onOffReadings = new float[onOff.sampleSize()];

		Boolean isMove = false; 
		Boolean isOn = false;
		Boolean isPressed = false;
		
		while (!Button.ESCAPE.isDown()) {
			propel.fetchSample(propelReadings, 0);
			onOff.fetchSample(onOffReadings, 0);
			
			// if the onOff touch sensor is triggered
			// start mowing
			if (onOffReadings[0]>0 && !isOn && !isPressed) {
				Button.LEDPattern(2);
				bladeMotor.forward();
				isPressed = true;
			}
			
			// if the onOff touch sensor is released
			// change isOn to true
			if (onOffReadings[0]==0 && !isOn && isPressed) {
				isOn = true;
				isPressed = false;
			}
			
			// if the onOff touch sensor is triggered again
			// stop mowing
			if (onOffReadings[0]>0 && isOn && !isPressed) {
				Button.LEDPattern(0);
				bladeMotor.stop();
				isOn = false;
				isPressed = true;
			}
			
			// if the onOff touch sensor is released
			// change isOn to true
			if (onOffReadings[0]==0 && !isOn && isPressed) {
				isOn = true;
				isPressed = false;
			}
			
			// if the propel touch sensor is triggered
			// start moving
			if (propelReadings[0]>0 && isOn && !isMove) {
				Button.LEDPattern(1);
				leftMotor.backward();
				rightMotor.backward();
				isMove = true;
			}
			
			// if the propel touch sensor is released
			// stop moving
			if (propelReadings[0]==0 && isOn && isMove) {
				Button.LEDPattern(2);
				leftMotor.stop(true);
				rightMotor.stop();
				isMove = false;
			}
		}

		// Close the sensors and motors and turn off the light
		onOff.close();
		propel.close();
		Button.LEDPattern(0);
	}
}
{% endhighlight %}